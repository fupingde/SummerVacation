## 吴瑞的ReadMe：

### 主页介绍：

这是一个由吴瑞和卢高山共同研发的一款音乐app，我主要负责的模块是主页的制作，音乐歌单的制作，歌曲的播放，歌曲的收藏（下载），歌单的收藏及播放，播放列表的制作
以下是简单的演示：
![Screenrecorder-2024-07-27-15-56-25-423 00_00_00-00_01_12~1](https://github.com/user-attachments/assets/fafe9cfe-a1ea-42e5-bd22-0ff4bcf21263)
     主界面中，最外层的view是一个buttomnavigation，也就是“发现”和“我的”，在点击之后会跳转到相应的页面中去，中间原本我是想用floatingactionbutton实现悬浮按钮，但是这个控件的坑实在是太多了，在尝试了一天之后果断放弃，改为imagebutton实现，在歌单中点击歌曲的时候会将数据传递到播放的activity中，在点击播放按钮的时候通过逻辑判断什么时候将音乐的信息传递到主页的activity中然后在底部按钮中显示图片，并设置点击事件，在点击时会再次跳转到播放的页面。

​     在上面的view的里面是顶部banner，顶部banner我使用了tablayout以及viewpager2实现了在主页能进行横向滑动，也就是切换”发现“与“推荐”页面，然后在各自页面上再写各自的内容。

​     在tablayout的发现部分下方，也就是viewpager2的内容中，最顶部是一个banner，每一段时间之后会自动滑动切换到下一个，这个功能是由viewpager2控件实现的，将请求到的图片url使用glide解析之后投放在顶部banner，然后为其设置点击事件，在点击之后会跳转到相应的浏览器页面，例：



![c4b079b2060dbaa86507416d6366ec44 00_00_00-00_00_30](D:\FFOutput\c4b079b2060dbaa86507416d6366ec44 00_00_00-00_00_30.gif)

下方有三个rv可以滑动，分别是“推荐歌单”、“热门歌单”、“唱片机”，这三个rv的嵌套滑动由于我对嵌套滑动的学习不够深入，所以使用了三天多也没能完美解决滑动冲突的问题，最终我使用了NestedScrollView：一种扩展了 ScrollView布局的布局来尝试解决滑动冲突问题，最后在上面提到的三个rv中，通过缓慢滑动可以滑动rv，如果快速滑动则会切换发现与推荐的tablayout。在最下方我做了一个与顶部banner类似的控件用于新歌曲的推荐，每过一段时间也会自动滑动，为它设计了点击之后跳转到播放这首音乐的界面，例：

![80109900cbf80b40c2cc38e704a4dd88 00_00_00-00_00_30](D:\FFOutput\80109900cbf80b40c2cc38e704a4dd88 00_00_00-00_00_30.gif)

### 歌单部分介绍：

​     在歌单中，我使用了协调者布局来实现apptablayout，实现在下滑之后隐藏顶部标题栏的滚动隐藏：



![Screenrecorder-2024-07-27-15-56-25-423 00_00_16-00_00_23](D:\FFOutput\Screenrecorder-2024-07-27-15-56-25-423 00_00_16-00_00_23.gif)

​     我将对应歌单的图片设为背景图片，在下方原本我是想再使用floatingactionbutton实现悬浮按钮，但是实在是太难用了，搞不定只能再次换成imagebutton，设置了两个按钮，分别是播放歌单以及收藏歌单。

### 歌曲播放部分的介绍

演示如下：

![Screenrecorder-2024-07-27-15-56-25-423 00_00_23-00_00_40](D:\FFOutput\Screenrecorder-2024-07-27-15-56-25-423 00_00_23-00_00_40.gif)

​     在点击歌单中的歌曲或者是点击主页底部的banner的时候会跳转到相应的歌曲播放界面，点击播放之后会显示歌词，通过对歌词的两行textview进行更改做出音乐播放器的歌词实时显示的效果，如果是在歌单中打开音乐播放界面，那么播放列表点击之后会显示这个歌单的音乐，点击可跳转到相应的歌曲进行播放，在左边是更换播放顺序，有循环播放，单曲循环以及随机播放，会在当前的播放列表中进行相应的播放，如果是搜索到的单曲进行播放则不会有播放列表，点击上一首或下一首的按钮也不会有反应。

​     播放歌曲我最开始是使用本地音乐播放库的，但是在我单模块测试完全没有问题但是一旦多模块就会出现无法播放的报错的情况下，换成了media3第三方库，这个第三方库不会影响多模块开发。实现在后台播放使用的是完成musicservice，在service的生命周期内实现与activity之间的通信，下方进度条的实现我是新开了一个新的线程，在音乐播放时每一秒执行一次，在点击进入播放页面时，updateui方法会将对应信息加载到seekbar上。

### “我的”页面介绍：

演示：

![Screenrecorder-2024-07-27-15-56-25-423 00_01_00-00_01_15](D:\FFOutput\Screenrecorder-2024-07-27-15-56-25-423 00_01_00-00_01_15.gif)

​     在“我的”页面，我做了收藏，本地以及收藏的歌单三个部分，收藏和本地均是通过SQlite数据库实现，在歌曲播放页面点击收藏或者下载按钮之后，会将歌曲信息传入到数据库当中，在每次进入歌曲播放页面之前会从数据库中查看是否有当前歌曲的信息，如果有的话就加载已经收藏的按钮背景。在“我的”页面中点击收藏和本地进入之后会加载数据库中的内容到其中，点击其中的歌曲进行播放，收藏歌单的原理大致相同，不再赘述。

### 总结与反思：

​    在寒假考核甚至五一考核之前我从未想过能手搓一个自己的功能相对完整的软件出来，这对于我之前来说可以说是天方夜谭，，五一考核的时候也只是写了一个残疾的小软件，这次的暑假考核却是要合作手搓一个完整软件。我能真正写出这个软件的一部分少不了其他同学的帮助，博客及csdn上大佬的分享以及学长的分享，如果真的让我独立完成可能到一半就坚持不住了。在这次考核结束之际，我充分意识到了自己的不足，对嵌套滑动的处理不当、对多模块的不熟悉、音乐播放逻辑的梳理不足，这些问题都阻挡过我对这个软件的开发，也是我以后进行开发的宝贵经验。